---
import Layout from "@layouts/Layout.astro";
import Introduction from "@components/Introduction.astro";
import Socials from "@components/Socials.astro";
import About from "@components/About.astro";
import Stack from "@components/Stack.astro";
import Projects from "@components/Projects.astro";
import Experience from "@components/Timeline.astro";

import profileImage from "@assets/images/profile.jpg";

import personal from "@data/personal.json";
import portfolio_info from "@data/portfolio_info.json";
import stack from "@data/stack.json";
import projects from "@data/projects.json";
import timeline from "@data/timeline.json";
import Timeline from "@components/Timeline.astro";

const {
	name,
	name_short,
	role,
	about,
	location,
	availability,
	github,
	linkedin,
} = personal;
const { title, description, menus: allMenus } = portfolio_info;

// choose which sections to show or hide
const showIntroduction = import.meta.env.SHOW_INTRODUCTION !== 'false';
const showSocials = import.meta.env.SHOW_SOCIALS !== 'false';
const showAbout = import.meta.env.SHOW_ABOUT !== 'false';
const showStack = import.meta.env.SHOW_STACK !== 'false';
const showProjects = import.meta.env.SHOW_PROJECTS !== 'false';
const showTimeline = import.meta.env.SHOW_TIMELINE !== 'false';

// map of section visibility
const visibleSections: Record<string, boolean> = {
	introduction: showIntroduction,
	socials: showSocials,
	about: showAbout,
	stack: showStack,
	projects: showProjects,
	timeline: showTimeline,
};

// filter menus based on visible sections
const menus = allMenus.filter((menu: any) => visibleSections[menu.id] !== false);
---

<Layout
	title={title}
	description={description}
	menus={menus}
	footer={{ github, linkedin }}
>
	{showIntroduction && (
		<section id="introduction">
			<Introduction
				{name}
				{name_short}
				{role}
				{location}
				{availability}
				{profileImage}
			/>
		</section>
	)}

	{showSocials && (
		<section id="socials">
			<Socials {github} {linkedin} />
		</section>
	)}

	{showAbout && (
		<section id="about">
			<About {about} />
		</section>
	)}

	{showStack && (
		<section id="stack">
			<Stack {stack} />
		</section>
	)}

	{showProjects && (
		<section id="projects">
			<Projects {projects} />
		</section>
	)}

	{showTimeline && (
		<section id="timeline">
			<Timeline events={timeline} />
		</section>
	)}

</Layout>
