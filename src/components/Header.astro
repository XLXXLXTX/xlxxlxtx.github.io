---
import ThemeButton from "@components/ThemeButton.astro";
// import Button from "@components/Button.astro";
interface MenuProps {
    menus: {
        href: string;
        label: string;
    }[];
}
const { menus } = Astro.props as MenuProps;
---

<header class="w-full bg-primary/80 backdrop-blur-md sticky top-0 z-50 transition-colors duration-300">
    <div class="max-w-4xl mx-auto px-6 border-b border-secondary/10 py-4 flex items-center justify-between gap-4">
        <nav class="hidden sm:block">
            <ul class="flex items-center w-full gap-6 text-tertiary font-medium">
                {
                    menus.map(({ href, label }) => (
                        <li>
                            <a class="hover:text-secondary transition-colors duration-300" href={href}>
                                {label}
                            </a>
                        </li>
                    ))
                }
            </ul>
        </nav>

        <div class="flex items-center gap-3 ml-auto">
            <ThemeButton />
            <button class="sm:hidden border border-secondary/20 rounded-md p-2 text-tertiary
                         hover:text-secondary hover:border-secondary/40 transition-colors duration-300"
                id="menu-toggle"
                aria-expanded="false"
                aria-controls="mobile-menu"
            >
                <iconify-icon icon="line-md:menu" width="20" height="20" />
            </button>
        </div>
    </div>

    <nav
        id="mobile-menu"
        class="sm:hidden hidden absolute top-14 right-6 rounded-lg shadow-lg z-40
               border border-secondary bg-secondary dark:bg-secondary dark:border-secondary"
    >
        <ul class="flex flex-col gap-1 px-3 py-2 text-white dark:text-primary font-medium text-sm">
            {
                menus.map(({ href, label }) => (
                    <li>
                        <a class="block px-3 py-1 rounded hover:bg-white/20 dark:hover:bg-black/20 transition-colors duration-300"
                            href={href}
                            data-mobile-link
                        >
                            {label}
                        </a>
                    </li>
                ))
            }
        </ul>
    </nav>
</header>

<script is:inline>
    const toggle = document.getElementById("menu-toggle");
    const mobileMenu = document.getElementById("mobile-menu");
    const links = mobileMenu?.querySelectorAll('[data-mobile-link]');

    const closeMenu = () => {
        mobileMenu?.classList.add("hidden");
        toggle?.setAttribute("aria-expanded", "false");
    };

    toggle?.addEventListener("click", () => {
        const isHidden = mobileMenu?.classList.contains("hidden");
        if (isHidden) {
            mobileMenu?.classList.remove("hidden");
            toggle.setAttribute("aria-expanded", "true");
        } else {
            closeMenu();
        }
    });

    links?.forEach((link) => {
        link.addEventListener("click", () => closeMenu());
    });

    // close menu when clicking outside
    document.addEventListener("click", (e) => {
        if (!mobileMenu?.contains(e.target) && !toggle?.contains(e.target)) {
            closeMenu();
        }
    });
</script>
